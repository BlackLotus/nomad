server {
   listen        80;
   server_name   www.example.com;

   location /nomadxt  {
       proxy_pass http://gui:8080;
       proxy_set_header Host $host;
       proxy_set_header X-Real-IP $remote_addr;
    #    root      /app/;
    #    try_files $uri /nomadxt/index.html;  # fall back to index.html to support routing
   }

   location /nomadxt/api {
       proxy_set_header Host $http_host;
       proxy_pass      http://api:8000;
   }

   location ~ ^/nomadxt/objects/(.*)$ {
       client_max_body_size 20g;
       resolver         127.0.0.11 ipv6=off;  # docker embedded DNS
       proxy_set_header Host $http_host;
       proxy_pass       http://minio:9000/$1;
       proxy_set_header X-Real-IP $remote_addr;
   }

    location ~ ^/nomadxt/kibana/(.*)$ {
        proxy_pass http://elk:5601/$1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
